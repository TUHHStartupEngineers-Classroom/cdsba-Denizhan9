{
  "hash": "c8073f69a518db82e8e0c625d6e4683b",
  "result": {
    "markdown": "---\ntitle: \"Difference-in-Differences\"\n---\n\n::: {.cell hash='08_did_cache/html/unnamed-chunk-1_d4c9d412ae3d6efc8337a44f4c7ec097'}\n\n```{.r .cell-code}\nlibrary(dplyr)\ndf <- readRDS(\"data/hospdd.rds\")\nstr(df)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\ntibble [7,368 Ã— 5] (S3: tbl_df/tbl/data.frame)\n $ hospital : num [1:7368] 1 1 1 1 1 1 1 1 1 1 ...\n  ..- attr(*, \"label\")= chr \"Hospital ID\"\n  ..- attr(*, \"format.stata\")= chr \"%9.0g\"\n $ frequency: 'int' num [1:7368] 3 2 4 2 1 1 2 4 2 2 ...\n  ..- attr(*, \"label\")= chr \"Hospital visit frequency\"\n  ..- attr(*, \"format.stata\")= chr \"%9.0g\"\n  ..- attr(*, \"labels\")= Named num [1:4] 1 2 3 4\n  .. ..- attr(*, \"names\")= chr [1:4] \"Low\" \"Medium\" \"High\" \"Very high\"\n $ month    : 'int' num [1:7368] 7 3 2 4 3 7 4 1 3 1 ...\n  ..- attr(*, \"label\")= chr \"Month\"\n  ..- attr(*, \"format.stata\")= chr \"%8.0g\"\n  ..- attr(*, \"labels\")= Named num [1:7] 1 2 3 4 5 6 7\n  .. ..- attr(*, \"names\")= chr [1:7] \"January\" \"February\" \"March\" \"April\" ...\n $ procedure: 'dbl' num [1:7368] 1 0 0 1 0 1 1 0 0 0 ...\n  ..- attr(*, \"label\")= chr \"Admission procedure\"\n  ..- attr(*, \"format.stata\")= chr \"%9.0g\"\n  ..- attr(*, \"labels\")= Named num [1:2] 0 1\n  .. ..- attr(*, \"names\")= chr [1:2] \"Old\" \"New\"\n $ satis    : num [1:7368] 4.11 3.32 3.41 3 3.11 ...\n  ..- attr(*, \"label\")= chr \"Patient satisfaction score\"\n  ..- attr(*, \"format.stata\")= chr \"%9.0g\"\n - attr(*, \"label\")= chr \"Artificial hospital admission procedure data\"\n```\n:::\n\n```{.r .cell-code}\n# Select the hospitals for which the new admission procedure will be applied\nnew_procedure_hospitals <- unique(df$hospital[df$procedure == 1])\nnew_procedure_hospitals\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18\n```\n:::\n\n```{.r .cell-code}\ntreated_data <- df %>% filter(hospital %in% new_procedure_hospitals)\nmean_satisfaction_tb <- treated_data %>% filter(month == 3) %>% summarise(mean_satisfaction_tb = mean(satis, na.rm = TRUE)) %>% pull(mean_satisfaction_tb)\nmean_satisfaction_ta <- treated_data %>% filter(month == 4) %>% summarise(mean_satisfaction_ta = mean(satis, na.rm = TRUE)) %>% pull(mean_satisfaction_ta)\n\ncontrol_data <- df %>% filter(!hospital %in% new_procedure_hospitals)\nmean_satisfaction_cb <- control_data %>% filter(month == 3) %>% summarise(mean_satisfaction_cb = mean(satis, na.rm = TRUE)) %>% pull(mean_satisfaction_cb)\nmean_satisfaction_ca <- control_data %>% filter(month == 4) %>% summarise(mean_satisfaction_ca = mean(satis, na.rm = TRUE)) %>% pull(mean_satisfaction_ca)\n\nDiD_estimate_b <- mean_satisfaction_ta - mean_satisfaction_cb\nDiD_estimate_a <- mean_satisfaction_tb - mean_satisfaction_ca\n\nDiD <- DiD_estimate_a - DiD_estimate_b\ncat(\"Estimated DiD: \", DiD)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nEstimated DiD:  -0.7932465\n```\n:::\n\n```{.r .cell-code}\nmodel1 <- lm(satis ~ procedure + month + hospital, data = df)\nsummary(model1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = satis ~ procedure + month + hospital, data = df)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-3.3126 -0.6548 -0.0933  0.5555  5.3347 \n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  3.538024   0.031365 112.801  < 2e-16 ***\nprocedure    0.886120   0.039143  22.638  < 2e-16 ***\nmonth       -0.004965   0.006392  -0.777 0.437378    \nhospital    -0.003731   0.001043  -3.576 0.000351 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.9836 on 7364 degrees of freedom\nMultiple R-squared:  0.1325,\tAdjusted R-squared:  0.1321 \nF-statistic: 374.8 on 3 and 7364 DF,  p-value: < 2.2e-16\n```\n:::\n\n```{.r .cell-code}\nmodel2 <- lm(satis ~ procedure + as.factor(month) + as.factor(hospital), data = df)\nsummary(model2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = satis ~ procedure + as.factor(month) + as.factor(hospital), \n    data = df)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-3.1880 -0.4644  0.0067  0.4539  4.2921 \n\nCoefficients:\n                        Estimate Std. Error t value Pr(>|t|)    \n(Intercept)            3.1716566  0.0562207  56.414  < 2e-16 ***\nprocedure              0.8479879  0.0342191  24.781  < 2e-16 ***\nas.factor(month)2     -0.0096077  0.0292119  -0.329 0.742244    \nas.factor(month)3      0.0219686  0.0292119   0.752 0.452050    \nas.factor(month)4     -0.0032839  0.0324936  -0.101 0.919504    \nas.factor(month)5     -0.0094027  0.0324936  -0.289 0.772305    \nas.factor(month)6     -0.0038375  0.0324936  -0.118 0.905990    \nas.factor(month)7     -0.0111941  0.0324936  -0.345 0.730478    \nas.factor(hospital)2   0.4085664  0.0772418   5.289 1.26e-07 ***\nas.factor(hospital)3   0.5336248  0.0793384   6.726 1.88e-11 ***\nas.factor(hospital)4   0.2275102  0.0739411   3.077 0.002099 ** \nas.factor(hospital)5  -0.1453529  0.0739411  -1.966 0.049360 *  \nas.factor(hospital)6   0.4478634  0.0739411   6.057 1.46e-09 ***\nas.factor(hospital)7   1.4044164  0.0714559  19.654  < 2e-16 ***\nas.factor(hospital)8   0.0718758  0.0763186   0.942 0.346333    \nas.factor(hospital)9  -1.5185150  0.0782447 -19.407  < 2e-16 ***\nas.factor(hospital)10  1.6828446  0.0772418  21.787  < 2e-16 ***\nas.factor(hospital)11  0.2209653  0.0763186   2.895 0.003799 ** \nas.factor(hospital)12 -0.0953034  0.0782447  -1.218 0.223256    \nas.factor(hospital)13  0.4955931  0.0754658   6.567 5.48e-11 ***\nas.factor(hospital)14  0.2330426  0.0793384   2.937 0.003321 ** \nas.factor(hospital)15 -0.1444935  0.0793384  -1.821 0.068613 .  \nas.factor(hospital)16  1.4142680  0.0772418  18.310  < 2e-16 ***\nas.factor(hospital)17  0.4235429  0.0805362   5.259 1.49e-07 ***\nas.factor(hospital)18  0.1532761  0.0938164   1.634 0.102346    \nas.factor(hospital)19 -0.7453017  0.0811623  -9.183  < 2e-16 ***\nas.factor(hospital)20  0.0473874  0.0791140   0.599 0.549207    \nas.factor(hospital)21  1.1943370  0.0836232  14.282  < 2e-16 ***\nas.factor(hospital)22  0.7993153  0.0823336   9.708  < 2e-16 ***\nas.factor(hospital)23  0.7017202  0.0811623   8.646  < 2e-16 ***\nas.factor(hospital)24 -0.3081260  0.0866402  -3.556 0.000378 ***\nas.factor(hospital)25  0.6464736  0.0927258   6.972 3.40e-12 ***\nas.factor(hospital)26  0.2142471  0.0791140   2.708 0.006783 ** \nas.factor(hospital)27 -0.3986544  0.0766106  -5.204 2.01e-07 ***\nas.factor(hospital)28  0.7119953  0.0836232   8.514  < 2e-16 ***\nas.factor(hospital)29  0.2485512  0.0800935   3.103 0.001921 ** \nas.factor(hospital)30 -0.1679220  0.0953638  -1.761 0.078304 .  \nas.factor(hospital)31  0.5120848  0.0791140   6.473 1.02e-10 ***\nas.factor(hospital)32 -0.3233456  0.0800935  -4.037 5.47e-05 ***\nas.factor(hospital)33 -0.4539752  0.0791140  -5.738 9.95e-09 ***\nas.factor(hospital)34 -0.0004123  0.0746054  -0.006 0.995590    \nas.factor(hospital)35  0.3541110  0.0766106   4.622 3.86e-06 ***\nas.factor(hospital)36  2.1381425  0.0773811  27.631  < 2e-16 ***\nas.factor(hospital)37  0.1404036  0.0927258   1.514 0.130023    \nas.factor(hospital)38 -0.0868060  0.0782129  -1.110 0.267093    \nas.factor(hospital)39 -0.0234969  0.0823336  -0.285 0.775356    \nas.factor(hospital)40  1.1215331  0.0782129  14.339  < 2e-16 ***\nas.factor(hospital)41 -0.1497346  0.0766106  -1.954 0.050681 .  \nas.factor(hospital)42  0.8811369  0.0850508  10.360  < 2e-16 ***\nas.factor(hospital)43 -0.7724325  0.0811623  -9.517  < 2e-16 ***\nas.factor(hospital)44  0.0344120  0.0904337   0.381 0.703569    \nas.factor(hospital)45 -0.2137495  0.0766106  -2.790 0.005283 ** \nas.factor(hospital)46  0.0784915  0.0823336   0.953 0.340452    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.7238 on 7315 degrees of freedom\nMultiple R-squared:  0.5333,\tAdjusted R-squared:  0.5299 \nF-statistic: 160.7 on 52 and 7315 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n\nThe main difference between including variables directly and as factors is how they are treated. When treated as factors, each unique value or level of the variable is considered a separate category. This means that for each hospital or month, different effects can be observed individually.",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}